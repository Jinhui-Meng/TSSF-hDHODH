# TSSF-hDHODH
a machine learning-based target-specific scoring function for structure-based binding affinity prediction for hDHODH inhibitors

# Requirements
* Python 3.7
* RDKit >= 2020 (http://www.rdkit.org/docs/Install.html)
* Scikit-learn 1.0.2
* Scipy >= 1.1.0
* Numpy >= 1.18.1
* Pandas >= 1.0.4
* Joblib >= 0.15

We suggest to run the code in a conda environment. We provide an `environment.yml` file that can be used to install the needed packages:

`conda env create -f environment.yaml `

# Example usage
The example folder provides how to predict binding affinity using TSSF-hDHODH.

First, `cd ./example`

**1. Structures and files preparation**

- You need to prepare the 3D structures in pdb format of the test compounds and the target protein, named as ID_ligand.pdb and ID_protein.pdb. (Note: ID must be 4 digits)
- The file in csv format for calculating interaction features where the first column is the ID and the second column is filled with the number 1. (e.g. data_iy.csv)
- The file in csv format for calculating ligand features contains at least two items: "Num_ID" and "SMILES". (e.g. data_smiles.csv)

All the above files are saved in the data folder.

**2. Features generation**

The interaction features are generated by `rf-prepare`, which proposed by Ballester et al. (Pedro J. Ballester and John B. O. Mitchell. A machine learning approach to predicting protein-ligand binding affinity with applications to molecular docking. Bioinformatics, 26(9):1169-1175, 2010. DOI: 10.1093/bioinformatics/btq112, https://github.com/lachrymator/RF-Score)

```
# Run the commandline
../features/rf-prepare ./data/data_iy.csv > ./data/data_yx42i.csv
```
The ligand features are generated by RDKit, after which feature selection and standardization are completed.

```
# Run the commandline
python getfeatures_test_2models.py
```

**3. Prediction**

You can use TSSF-hDHODH-a or TSSF-hDHODH-b individually to make predictions, or consider the results of the both models together.

```
# Run the commandline
# arg1: features file, arg2: model type
# Note: feature file and model type need to be consistent

python predict_tssf.py test_features_a.csv a
python predict_tssf.py test_features_b.csv b
```




